module: memory.backends
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_AbstractVectorStore_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - backends.read
    - backends.write
    action: 'AbstractVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for AbstractVectorStore(content: str, metadata: dict)
    -> str'
- name: guest_VectorDocument_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: VectorDocument() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for VectorDocument() -> bool
- name: guest_SearchResult_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: SearchResult() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for SearchResult() -> bool
- name: guest_StorageStats_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: StorageStats() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for StorageStats() -> bool
- name: guest_PgVectorStore_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'PgVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for PgVectorStore(content: str, metadata: dict) -> str'
- name: guest_FAISSStore_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'FAISSStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for FAISSStore(content: str, metadata: dict) -> str'
- name: guest_InMemoryVectorStore_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'InMemoryVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for InMemoryVectorStore(content: str, metadata: dict)
    -> str'
- name: visitor_AbstractVectorStore_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'AbstractVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for AbstractVectorStore(content: str, metadata: dict)
    -> str'
- name: visitor_VectorDocument_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: VectorDocument() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for VectorDocument() -> bool
- name: visitor_SearchResult_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: SearchResult() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for SearchResult() -> bool
- name: visitor_StorageStats_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: StorageStats() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for StorageStats() -> bool
- name: visitor_PgVectorStore_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'PgVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for PgVectorStore(content: str, metadata: dict) ->
    str'
- name: visitor_FAISSStore_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'FAISSStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for FAISSStore(content: str, metadata: dict) -> str'
- name: visitor_InMemoryVectorStore_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'InMemoryVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for InMemoryVectorStore(content: str, metadata: dict)
    -> str'
- name: friend_AbstractVectorStore_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'AbstractVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for AbstractVectorStore(content: str, metadata: dict)
    -> str'
- name: friend_VectorDocument_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: VectorDocument() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for VectorDocument() -> bool
- name: friend_SearchResult_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: SearchResult() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for SearchResult() -> bool
- name: friend_StorageStats_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: StorageStats() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for StorageStats() -> bool
- name: friend_PgVectorStore_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'PgVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for PgVectorStore(content: str, metadata: dict) -> str'
- name: friend_FAISSStore_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'FAISSStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for FAISSStore(content: str, metadata: dict) -> str'
- name: friend_InMemoryVectorStore_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'InMemoryVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for InMemoryVectorStore(content: str, metadata: dict)
    -> str'
- name: trusted_AbstractVectorStore_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'AbstractVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for AbstractVectorStore(content: str, metadata: dict)
    -> str'
- name: trusted_VectorDocument_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: VectorDocument() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for VectorDocument() -> bool
- name: trusted_SearchResult_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: SearchResult() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for SearchResult() -> bool
- name: trusted_StorageStats_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: StorageStats() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for StorageStats() -> bool
- name: trusted_PgVectorStore_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'PgVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for PgVectorStore(content: str, metadata: dict) ->
    str'
- name: trusted_FAISSStore_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'FAISSStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for FAISSStore(content: str, metadata: dict) -> str'
- name: trusted_InMemoryVectorStore_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'InMemoryVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for InMemoryVectorStore(content: str, metadata: dict)
    -> str'
- name: inner_circle_AbstractVectorStore_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'AbstractVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for AbstractVectorStore(content: str, metadata:
    dict) -> str'
- name: inner_circle_VectorDocument_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: VectorDocument() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for VectorDocument() -> bool
- name: inner_circle_SearchResult_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: SearchResult() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for SearchResult() -> bool
- name: inner_circle_StorageStats_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: StorageStats() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for StorageStats() -> bool
- name: inner_circle_PgVectorStore_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'PgVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for PgVectorStore(content: str, metadata: dict)
    -> str'
- name: inner_circle_FAISSStore_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'FAISSStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for FAISSStore(content: str, metadata: dict)
    -> str'
- name: inner_circle_InMemoryVectorStore_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'InMemoryVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for InMemoryVectorStore(content: str, metadata:
    dict) -> str'
- name: root_dev_AbstractVectorStore_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'AbstractVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for AbstractVectorStore(content: str, metadata: dict)
    -> str'
- name: root_dev_VectorDocument_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: VectorDocument() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for VectorDocument() -> bool
- name: root_dev_SearchResult_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: SearchResult() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for SearchResult() -> bool
- name: root_dev_StorageStats_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: StorageStats() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for StorageStats() -> bool
- name: root_dev_PgVectorStore_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'PgVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for PgVectorStore(content: str, metadata: dict) ->
    str'
- name: root_dev_FAISSStore_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'FAISSStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for FAISSStore(content: str, metadata: dict) -> str'
- name: root_dev_InMemoryVectorStore_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'InMemoryVectorStore(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for InMemoryVectorStore(content: str, metadata: dict)
    -> str'
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - backends.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Unknown service account
