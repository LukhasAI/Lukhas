module: rl.engine
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_ConsciousnessAction_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - engine.read
    - engine.write
    action: ConsciousnessAction() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessAction() -> bool
- name: guest_ConsciousnessActionType_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessActionType() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessActionType() -> bool
- name: guest_ConsciousnessActorCritic_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessActorCritic() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessActorCritic() -> bool
- name: guest_ConsciousnessAttention_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessAttention() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessAttention() -> bool
- name: guest_ConsciousnessEnvironment_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessEnvironment() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessEnvironment() -> bool
- name: guest_ConsciousnessPolicy_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessPolicy() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessPolicy() -> bool
- name: guest_ConsciousnessState_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessState() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessState() -> bool
- name: guest_ConsciousnessValueNetwork_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConsciousnessValueNetwork() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConsciousnessValueNetwork() -> bool
- name: guest_EthicalConstraintModule_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: EthicalConstraintModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for EthicalConstraintModule() -> bool
- name: guest_ReflectionModule_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ReflectionModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ReflectionModule() -> bool
- name: visitor_ConsciousnessAction_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessAction() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessAction() -> bool
- name: visitor_ConsciousnessActionType_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessActionType() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessActionType() -> bool
- name: visitor_ConsciousnessActorCritic_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessActorCritic() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessActorCritic() -> bool
- name: visitor_ConsciousnessAttention_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessAttention() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessAttention() -> bool
- name: visitor_ConsciousnessEnvironment_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessEnvironment() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessEnvironment() -> bool
- name: visitor_ConsciousnessPolicy_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessPolicy() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessPolicy() -> bool
- name: visitor_ConsciousnessState_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessState() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessState() -> bool
- name: visitor_ConsciousnessValueNetwork_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConsciousnessValueNetwork() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConsciousnessValueNetwork() -> bool
- name: visitor_EthicalConstraintModule_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: EthicalConstraintModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for EthicalConstraintModule() -> bool
- name: visitor_ReflectionModule_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ReflectionModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ReflectionModule() -> bool
- name: friend_ConsciousnessAction_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessAction() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessAction() -> bool
- name: friend_ConsciousnessActionType_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessActionType() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessActionType() -> bool
- name: friend_ConsciousnessActorCritic_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessActorCritic() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessActorCritic() -> bool
- name: friend_ConsciousnessAttention_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessAttention() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessAttention() -> bool
- name: friend_ConsciousnessEnvironment_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessEnvironment() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessEnvironment() -> bool
- name: friend_ConsciousnessPolicy_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessPolicy() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessPolicy() -> bool
- name: friend_ConsciousnessState_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessState() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessState() -> bool
- name: friend_ConsciousnessValueNetwork_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConsciousnessValueNetwork() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ConsciousnessValueNetwork() -> bool
- name: friend_EthicalConstraintModule_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: EthicalConstraintModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for EthicalConstraintModule() -> bool
- name: friend_ReflectionModule_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ReflectionModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for ReflectionModule() -> bool
- name: trusted_ConsciousnessAction_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessAction() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessAction() -> bool
- name: trusted_ConsciousnessActionType_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessActionType() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessActionType() -> bool
- name: trusted_ConsciousnessActorCritic_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessActorCritic() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessActorCritic() -> bool
- name: trusted_ConsciousnessAttention_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessAttention() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessAttention() -> bool
- name: trusted_ConsciousnessEnvironment_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessEnvironment() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessEnvironment() -> bool
- name: trusted_ConsciousnessPolicy_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessPolicy() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessPolicy() -> bool
- name: trusted_ConsciousnessState_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessState() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessState() -> bool
- name: trusted_ConsciousnessValueNetwork_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConsciousnessValueNetwork() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConsciousnessValueNetwork() -> bool
- name: trusted_EthicalConstraintModule_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: EthicalConstraintModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for EthicalConstraintModule() -> bool
- name: trusted_ReflectionModule_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ReflectionModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ReflectionModule() -> bool
- name: inner_circle_ConsciousnessAction_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessAction() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessAction() -> bool
- name: inner_circle_ConsciousnessActionType_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessActionType() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessActionType() -> bool
- name: inner_circle_ConsciousnessActorCritic_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessActorCritic() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessActorCritic() -> bool
- name: inner_circle_ConsciousnessAttention_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessAttention() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessAttention() -> bool
- name: inner_circle_ConsciousnessEnvironment_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessEnvironment() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessEnvironment() -> bool
- name: inner_circle_ConsciousnessPolicy_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessPolicy() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessPolicy() -> bool
- name: inner_circle_ConsciousnessState_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessState() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessState() -> bool
- name: inner_circle_ConsciousnessValueNetwork_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConsciousnessValueNetwork() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConsciousnessValueNetwork() -> bool
- name: inner_circle_EthicalConstraintModule_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: EthicalConstraintModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for EthicalConstraintModule() -> bool
- name: inner_circle_ReflectionModule_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ReflectionModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ReflectionModule() -> bool
- name: root_dev_ConsciousnessAction_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessAction() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessAction() -> bool
- name: root_dev_ConsciousnessActionType_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessActionType() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessActionType() -> bool
- name: root_dev_ConsciousnessActorCritic_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessActorCritic() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessActorCritic() -> bool
- name: root_dev_ConsciousnessAttention_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessAttention() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessAttention() -> bool
- name: root_dev_ConsciousnessEnvironment_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessEnvironment() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessEnvironment() -> bool
- name: root_dev_ConsciousnessPolicy_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessPolicy() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessPolicy() -> bool
- name: root_dev_ConsciousnessState_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessState() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessState() -> bool
- name: root_dev_ConsciousnessValueNetwork_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConsciousnessValueNetwork() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConsciousnessValueNetwork() -> bool
- name: root_dev_EthicalConstraintModule_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: EthicalConstraintModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for EthicalConstraintModule() -> bool
- name: root_dev_ReflectionModule_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ReflectionModule() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ReflectionModule() -> bool
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - engine.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Unknown service account
