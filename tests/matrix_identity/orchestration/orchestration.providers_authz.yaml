module: orchestration.providers
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_BaseAIClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - providers.read
    - providers.write
    action: BaseAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for BaseAIClient() -> bool
- name: guest_AIResponse_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: AIResponse() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for AIResponse() -> bool
- name: guest_AIError_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: AIError() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for AIError() -> bool
- name: guest_AIProvider_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: AIProvider() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for AIProvider() -> bool
- name: guest_OpenAIClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: OpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for OpenAIClient() -> bool
- name: guest_AnthropicClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: AnthropicClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for AnthropicClient() -> bool
- name: guest_GoogleClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: GoogleClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for GoogleClient() -> bool
- name: guest_MockAIClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: MockAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for MockAIClient() -> bool
- name: guest_create_provider_client_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'create_provider_client(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for create_provider_client(params: dict) -> str'
- name: guest_get_provider_status_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'get_provider_status(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for get_provider_status(id: str) -> dict'
- name: visitor_BaseAIClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: BaseAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for BaseAIClient() -> bool
- name: visitor_AIResponse_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: AIResponse() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for AIResponse() -> bool
- name: visitor_AIError_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: AIError() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for AIError() -> bool
- name: visitor_AIProvider_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: AIProvider() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for AIProvider() -> bool
- name: visitor_OpenAIClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: OpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for OpenAIClient() -> bool
- name: visitor_AnthropicClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: AnthropicClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for AnthropicClient() -> bool
- name: visitor_GoogleClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: GoogleClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for GoogleClient() -> bool
- name: visitor_MockAIClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: MockAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for MockAIClient() -> bool
- name: visitor_create_provider_client_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'create_provider_client(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for create_provider_client(params: dict) -> str'
- name: visitor_get_provider_status_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'get_provider_status(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for get_provider_status(id: str) -> dict'
- name: friend_BaseAIClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: BaseAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for BaseAIClient() -> bool
- name: friend_AIResponse_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: AIResponse() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for AIResponse() -> bool
- name: friend_AIError_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: AIError() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for AIError() -> bool
- name: friend_AIProvider_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: AIProvider() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for AIProvider() -> bool
- name: friend_OpenAIClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: OpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for OpenAIClient() -> bool
- name: friend_AnthropicClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: AnthropicClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for AnthropicClient() -> bool
- name: friend_GoogleClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: GoogleClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for GoogleClient() -> bool
- name: friend_MockAIClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: MockAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for MockAIClient() -> bool
- name: friend_create_provider_client_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'create_provider_client(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for create_provider_client(params: dict) -> str'
- name: friend_get_provider_status_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'get_provider_status(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for get_provider_status(id: str) -> dict'
- name: trusted_BaseAIClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: BaseAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for BaseAIClient() -> bool
- name: trusted_AIResponse_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: AIResponse() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for AIResponse() -> bool
- name: trusted_AIError_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: AIError() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for AIError() -> bool
- name: trusted_AIProvider_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: AIProvider() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for AIProvider() -> bool
- name: trusted_OpenAIClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: OpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for OpenAIClient() -> bool
- name: trusted_AnthropicClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: AnthropicClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for AnthropicClient() -> bool
- name: trusted_GoogleClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: GoogleClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for GoogleClient() -> bool
- name: trusted_MockAIClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: MockAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for MockAIClient() -> bool
- name: trusted_create_provider_client_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'create_provider_client(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for create_provider_client(params: dict) -> str'
- name: trusted_get_provider_status_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'get_provider_status(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for get_provider_status(id: str) -> dict'
- name: inner_circle_BaseAIClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: BaseAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for BaseAIClient() -> bool
- name: inner_circle_AIResponse_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: AIResponse() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for AIResponse() -> bool
- name: inner_circle_AIError_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: AIError() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for AIError() -> bool
- name: inner_circle_AIProvider_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: AIProvider() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for AIProvider() -> bool
- name: inner_circle_OpenAIClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: OpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for OpenAIClient() -> bool
- name: inner_circle_AnthropicClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: AnthropicClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for AnthropicClient() -> bool
- name: inner_circle_GoogleClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: GoogleClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for GoogleClient() -> bool
- name: inner_circle_MockAIClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: MockAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for MockAIClient() -> bool
- name: inner_circle_create_provider_client_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'create_provider_client(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for create_provider_client(params: dict) -> str'
- name: inner_circle_get_provider_status_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'get_provider_status(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for get_provider_status(id: str) -> dict'
- name: root_dev_BaseAIClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: BaseAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for BaseAIClient() -> bool
- name: root_dev_AIResponse_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: AIResponse() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for AIResponse() -> bool
- name: root_dev_AIError_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: AIError() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for AIError() -> bool
- name: root_dev_AIProvider_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: AIProvider() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for AIProvider() -> bool
- name: root_dev_OpenAIClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: OpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for OpenAIClient() -> bool
- name: root_dev_AnthropicClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: AnthropicClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for AnthropicClient() -> bool
- name: root_dev_GoogleClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: GoogleClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for GoogleClient() -> bool
- name: root_dev_MockAIClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: MockAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for MockAIClient() -> bool
- name: root_dev_create_provider_client_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'create_provider_client(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for create_provider_client(params: dict) -> str'
- name: root_dev_get_provider_status_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'get_provider_status(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for get_provider_status(id: str) -> dict'
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - providers.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Unknown service account
