module: bridge.llm_wrappers
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_GPTClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - llm_wrappers.read
    - llm_wrappers.write
    action: GPTClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for GPTClient() -> bool
- name: guest_LukhasOpenAIClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: LukhasOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for LukhasOpenAIClient() -> bool
- name: guest_OpenAIModulatedService_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: OpenAIModulatedService() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for OpenAIModulatedService() -> bool
- name: guest_OpenAIWrapper_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: OpenAIWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for OpenAIWrapper() -> bool
- name: guest_UnifiedOpenAIClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: UnifiedOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for UnifiedOpenAIClient() -> bool
- name: visitor_GPTClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: GPTClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for GPTClient() -> bool
- name: visitor_LukhasOpenAIClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: LukhasOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for LukhasOpenAIClient() -> bool
- name: visitor_OpenAIModulatedService_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: OpenAIModulatedService() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for OpenAIModulatedService() -> bool
- name: visitor_OpenAIWrapper_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: OpenAIWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for OpenAIWrapper() -> bool
- name: visitor_UnifiedOpenAIClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: UnifiedOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for UnifiedOpenAIClient() -> bool
- name: friend_GPTClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: GPTClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for GPTClient() -> bool
- name: friend_LukhasOpenAIClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: LukhasOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for LukhasOpenAIClient() -> bool
- name: friend_OpenAIModulatedService_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: OpenAIModulatedService() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for OpenAIModulatedService() -> bool
- name: friend_OpenAIWrapper_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: OpenAIWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for OpenAIWrapper() -> bool
- name: friend_UnifiedOpenAIClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: UnifiedOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for UnifiedOpenAIClient() -> bool
- name: trusted_GPTClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: GPTClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for GPTClient() -> bool
- name: trusted_LukhasOpenAIClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: LukhasOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for LukhasOpenAIClient() -> bool
- name: trusted_OpenAIModulatedService_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: OpenAIModulatedService() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for OpenAIModulatedService() -> bool
- name: trusted_OpenAIWrapper_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: OpenAIWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for OpenAIWrapper() -> bool
- name: trusted_UnifiedOpenAIClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: UnifiedOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for UnifiedOpenAIClient() -> bool
- name: inner_circle_GPTClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: GPTClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for GPTClient() -> bool
- name: inner_circle_LukhasOpenAIClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: LukhasOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for LukhasOpenAIClient() -> bool
- name: inner_circle_OpenAIModulatedService_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: OpenAIModulatedService() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for OpenAIModulatedService() -> bool
- name: inner_circle_OpenAIWrapper_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: OpenAIWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for OpenAIWrapper() -> bool
- name: inner_circle_UnifiedOpenAIClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: UnifiedOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for UnifiedOpenAIClient() -> bool
- name: root_dev_GPTClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: GPTClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for GPTClient() -> bool
- name: root_dev_LukhasOpenAIClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: LukhasOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for LukhasOpenAIClient() -> bool
- name: root_dev_OpenAIModulatedService_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: OpenAIModulatedService() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for OpenAIModulatedService() -> bool
- name: root_dev_OpenAIWrapper_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: OpenAIWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for OpenAIWrapper() -> bool
- name: root_dev_UnifiedOpenAIClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: UnifiedOpenAIClient() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for UnifiedOpenAIClient() -> bool
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - llm_wrappers.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
