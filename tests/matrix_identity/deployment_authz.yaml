module: deployment
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_LaneManager_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - deployment.read
    - deployment.write
    action: LaneManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for LaneManager() -> bool
- name: guest_CanaryController_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: CanaryController() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for CanaryController() -> bool
- name: guest_TrafficRouter_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: TrafficRouter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for TrafficRouter() -> bool
- name: guest_HealthMonitor_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: HealthMonitor() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for HealthMonitor() -> bool
- name: guest_DeploymentPipeline_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: DeploymentPipeline() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for DeploymentPipeline() -> bool
- name: guest_ConfigurationManager_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ConfigurationManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for ConfigurationManager() -> bool
- name: guest_RollbackSystem_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: RollbackSystem() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for RollbackSystem() -> bool
- name: guest_DeploymentCoordinator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: DeploymentCoordinator() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for DeploymentCoordinator() -> bool
- name: visitor_LaneManager_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: LaneManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for LaneManager() -> bool
- name: visitor_CanaryController_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: CanaryController() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for CanaryController() -> bool
- name: visitor_TrafficRouter_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: TrafficRouter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for TrafficRouter() -> bool
- name: visitor_HealthMonitor_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: HealthMonitor() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for HealthMonitor() -> bool
- name: visitor_DeploymentPipeline_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: DeploymentPipeline() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for DeploymentPipeline() -> bool
- name: visitor_ConfigurationManager_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ConfigurationManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for ConfigurationManager() -> bool
- name: visitor_RollbackSystem_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: RollbackSystem() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for RollbackSystem() -> bool
- name: visitor_DeploymentCoordinator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: DeploymentCoordinator() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for DeploymentCoordinator() -> bool
- name: friend_LaneManager_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: LaneManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for LaneManager() -> bool
- name: friend_CanaryController_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: CanaryController() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for CanaryController() -> bool
- name: friend_TrafficRouter_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: TrafficRouter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for TrafficRouter() -> bool
- name: friend_HealthMonitor_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: HealthMonitor() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for HealthMonitor() -> bool
- name: friend_DeploymentPipeline_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: DeploymentPipeline() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for DeploymentPipeline() -> bool
- name: friend_ConfigurationManager_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ConfigurationManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for ConfigurationManager() -> bool
- name: friend_RollbackSystem_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: RollbackSystem() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for RollbackSystem() -> bool
- name: friend_DeploymentCoordinator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: DeploymentCoordinator() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier friend allowed for DeploymentCoordinator() -> bool
- name: trusted_LaneManager_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: LaneManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for LaneManager() -> bool
- name: trusted_CanaryController_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: CanaryController() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for CanaryController() -> bool
- name: trusted_TrafficRouter_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: TrafficRouter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for TrafficRouter() -> bool
- name: trusted_HealthMonitor_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: HealthMonitor() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for HealthMonitor() -> bool
- name: trusted_DeploymentPipeline_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: DeploymentPipeline() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for DeploymentPipeline() -> bool
- name: trusted_ConfigurationManager_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ConfigurationManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for ConfigurationManager() -> bool
- name: trusted_RollbackSystem_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: RollbackSystem() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for RollbackSystem() -> bool
- name: trusted_DeploymentCoordinator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: DeploymentCoordinator() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for DeploymentCoordinator() -> bool
- name: inner_circle_LaneManager_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: LaneManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for LaneManager() -> bool
- name: inner_circle_CanaryController_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: CanaryController() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for CanaryController() -> bool
- name: inner_circle_TrafficRouter_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: TrafficRouter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for TrafficRouter() -> bool
- name: inner_circle_HealthMonitor_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: HealthMonitor() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for HealthMonitor() -> bool
- name: inner_circle_DeploymentPipeline_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: DeploymentPipeline() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for DeploymentPipeline() -> bool
- name: inner_circle_ConfigurationManager_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ConfigurationManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for ConfigurationManager() -> bool
- name: inner_circle_RollbackSystem_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: RollbackSystem() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for RollbackSystem() -> bool
- name: inner_circle_DeploymentCoordinator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: DeploymentCoordinator() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for DeploymentCoordinator() -> bool
- name: root_dev_LaneManager_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: LaneManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for LaneManager() -> bool
- name: root_dev_CanaryController_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: CanaryController() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for CanaryController() -> bool
- name: root_dev_TrafficRouter_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: TrafficRouter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for TrafficRouter() -> bool
- name: root_dev_HealthMonitor_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: HealthMonitor() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for HealthMonitor() -> bool
- name: root_dev_DeploymentPipeline_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: DeploymentPipeline() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for DeploymentPipeline() -> bool
- name: root_dev_ConfigurationManager_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ConfigurationManager() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for ConfigurationManager() -> bool
- name: root_dev_RollbackSystem_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: RollbackSystem() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for RollbackSystem() -> bool
- name: root_dev_DeploymentCoordinator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: DeploymentCoordinator() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for DeploymentCoordinator() -> bool
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - deployment.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
