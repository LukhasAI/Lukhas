module: core.registry
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_PluginRegistry_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - registry.read
    - registry.write
    - registry.admin
    action: PluginRegistry() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for PluginRegistry() -> bool
- name: guest_PluginBase_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: PluginBase() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for PluginBase() -> bool
- name: guest_PluginInfo_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: PluginInfo() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for PluginInfo() -> bool
- name: guest_LUKHASPlugin_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: LUKHASPlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for LUKHASPlugin() -> bool
- name: guest_get_plugin_registry_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'get_plugin_registry(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for get_plugin_registry(id: str) -> dict'
- name: guest_register_plugin_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: register_plugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for register_plugin() -> bool
- name: guest_register_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: register() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for register() -> bool
- name: guest_resolve_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: resolve() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for resolve() -> bool
- name: guest_autoload_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: autoload() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for autoload() -> bool
- name: guest_discover_entry_points_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: discover_entry_points() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for discover_entry_points() -> bool
- name: visitor_PluginRegistry_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: PluginRegistry() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for PluginRegistry() -> bool
- name: visitor_PluginBase_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: PluginBase() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for PluginBase() -> bool
- name: visitor_PluginInfo_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: PluginInfo() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for PluginInfo() -> bool
- name: visitor_LUKHASPlugin_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: LUKHASPlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for LUKHASPlugin() -> bool
- name: visitor_get_plugin_registry_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'get_plugin_registry(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for get_plugin_registry(id: str) -> dict'
- name: visitor_register_plugin_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: register_plugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for register_plugin() -> bool
- name: visitor_register_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: register() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for register() -> bool
- name: visitor_resolve_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: resolve() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for resolve() -> bool
- name: visitor_autoload_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: autoload() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for autoload() -> bool
- name: visitor_discover_entry_points_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: discover_entry_points() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for discover_entry_points() -> bool
- name: friend_PluginRegistry_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: PluginRegistry() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for PluginRegistry() -> bool
- name: friend_PluginBase_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: PluginBase() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for PluginBase() -> bool
- name: friend_PluginInfo_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: PluginInfo() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for PluginInfo() -> bool
- name: friend_LUKHASPlugin_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: LUKHASPlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for LUKHASPlugin() -> bool
- name: friend_get_plugin_registry_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'get_plugin_registry(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier friend denied for get_plugin_registry(id: str) -> dict'
- name: friend_register_plugin_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: register_plugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for register_plugin() -> bool
- name: friend_register_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: register() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for register() -> bool
- name: friend_resolve_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: resolve() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for resolve() -> bool
- name: friend_autoload_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: autoload() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for autoload() -> bool
- name: friend_discover_entry_points_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: discover_entry_points() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for discover_entry_points() -> bool
- name: trusted_PluginRegistry_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: PluginRegistry() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for PluginRegistry() -> bool
- name: trusted_PluginBase_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: PluginBase() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for PluginBase() -> bool
- name: trusted_PluginInfo_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: PluginInfo() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for PluginInfo() -> bool
- name: trusted_LUKHASPlugin_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: LUKHASPlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for LUKHASPlugin() -> bool
- name: trusted_get_plugin_registry_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'get_plugin_registry(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier trusted denied for get_plugin_registry(id: str) -> dict'
- name: trusted_register_plugin_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: register_plugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for register_plugin() -> bool
- name: trusted_register_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: register() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for register() -> bool
- name: trusted_resolve_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: resolve() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for resolve() -> bool
- name: trusted_autoload_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: autoload() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for autoload() -> bool
- name: trusted_discover_entry_points_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: discover_entry_points() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for discover_entry_points() -> bool
- name: inner_circle_PluginRegistry_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: PluginRegistry() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for PluginRegistry() -> bool
- name: inner_circle_PluginBase_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: PluginBase() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for PluginBase() -> bool
- name: inner_circle_PluginInfo_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: PluginInfo() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for PluginInfo() -> bool
- name: inner_circle_LUKHASPlugin_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: LUKHASPlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for LUKHASPlugin() -> bool
- name: inner_circle_get_plugin_registry_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'get_plugin_registry(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for get_plugin_registry(id: str) -> dict'
- name: inner_circle_register_plugin_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: register_plugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for register_plugin() -> bool
- name: inner_circle_register_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: register() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for register() -> bool
- name: inner_circle_resolve_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: resolve() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for resolve() -> bool
- name: inner_circle_autoload_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: autoload() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for autoload() -> bool
- name: inner_circle_discover_entry_points_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: discover_entry_points() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for discover_entry_points() -> bool
- name: root_dev_PluginRegistry_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: PluginRegistry() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for PluginRegistry() -> bool
- name: root_dev_PluginBase_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: PluginBase() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for PluginBase() -> bool
- name: root_dev_PluginInfo_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: PluginInfo() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for PluginInfo() -> bool
- name: root_dev_LUKHASPlugin_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: LUKHASPlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for LUKHASPlugin() -> bool
- name: root_dev_get_plugin_registry_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'get_plugin_registry(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for get_plugin_registry(id: str) -> dict'
- name: root_dev_register_plugin_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: register_plugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for register_plugin() -> bool
- name: root_dev_register_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: register() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for register() -> bool
- name: root_dev_resolve_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: resolve() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for resolve() -> bool
- name: root_dev_autoload_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: autoload() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for autoload() -> bool
- name: root_dev_discover_entry_points_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: discover_entry_points() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for discover_entry_points() -> bool
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_guardian_allowed
  input:
    subject: lukhas:svc:guardian
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_consciousness_allowed
  input:
    subject: lukhas:svc:consciousness
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Unknown service account
