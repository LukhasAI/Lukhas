module: core.matriz
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_AsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - matriz.read
    - matriz.write
    - matriz.admin
    action: AsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for AsyncOrchestrator() -> bool
- name: guest_MockAsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: MockAsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for MockAsyncOrchestrator() -> bool
- name: guest_PipelineResult_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: PipelineResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for PipelineResult() -> bool
- name: guest_PipelineStage_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: PipelineStage() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for PipelineStage() -> bool
- name: guest_StageResult_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: StageResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for StageResult() -> bool
- name: guest_StagePlugin_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: StagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for StagePlugin() -> bool
- name: guest_BaseStagePlugin_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: BaseStagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for BaseStagePlugin() -> bool
- name: visitor_AsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: AsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for AsyncOrchestrator() -> bool
- name: visitor_MockAsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: MockAsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for MockAsyncOrchestrator() -> bool
- name: visitor_PipelineResult_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: PipelineResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for PipelineResult() -> bool
- name: visitor_PipelineStage_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: PipelineStage() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for PipelineStage() -> bool
- name: visitor_StageResult_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: StageResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for StageResult() -> bool
- name: visitor_StagePlugin_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: StagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for StagePlugin() -> bool
- name: visitor_BaseStagePlugin_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: BaseStagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for BaseStagePlugin() -> bool
- name: friend_AsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: AsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for AsyncOrchestrator() -> bool
- name: friend_MockAsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: MockAsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for MockAsyncOrchestrator() -> bool
- name: friend_PipelineResult_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: PipelineResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for PipelineResult() -> bool
- name: friend_PipelineStage_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: PipelineStage() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for PipelineStage() -> bool
- name: friend_StageResult_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: StageResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for StageResult() -> bool
- name: friend_StagePlugin_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: StagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for StagePlugin() -> bool
- name: friend_BaseStagePlugin_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: BaseStagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for BaseStagePlugin() -> bool
- name: trusted_AsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: AsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for AsyncOrchestrator() -> bool
- name: trusted_MockAsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: MockAsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for MockAsyncOrchestrator() -> bool
- name: trusted_PipelineResult_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: PipelineResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for PipelineResult() -> bool
- name: trusted_PipelineStage_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: PipelineStage() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for PipelineStage() -> bool
- name: trusted_StageResult_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: StageResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for StageResult() -> bool
- name: trusted_StagePlugin_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: StagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for StagePlugin() -> bool
- name: trusted_BaseStagePlugin_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: BaseStagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for BaseStagePlugin() -> bool
- name: inner_circle_AsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: AsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for AsyncOrchestrator() -> bool
- name: inner_circle_MockAsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: MockAsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for MockAsyncOrchestrator() -> bool
- name: inner_circle_PipelineResult_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: PipelineResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for PipelineResult() -> bool
- name: inner_circle_PipelineStage_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: PipelineStage() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for PipelineStage() -> bool
- name: inner_circle_StageResult_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: StageResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for StageResult() -> bool
- name: inner_circle_StagePlugin_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: StagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for StagePlugin() -> bool
- name: inner_circle_BaseStagePlugin_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: BaseStagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for BaseStagePlugin() -> bool
- name: root_dev_AsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: AsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for AsyncOrchestrator() -> bool
- name: root_dev_MockAsyncOrchestrator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: MockAsyncOrchestrator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for MockAsyncOrchestrator() -> bool
- name: root_dev_PipelineResult_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: PipelineResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for PipelineResult() -> bool
- name: root_dev_PipelineStage_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: PipelineStage() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for PipelineStage() -> bool
- name: root_dev_StageResult_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: StageResult() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for StageResult() -> bool
- name: root_dev_StagePlugin_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: StagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for StagePlugin() -> bool
- name: root_dev_BaseStagePlugin_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: BaseStagePlugin() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for BaseStagePlugin() -> bool
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_guardian_allowed
  input:
    subject: lukhas:svc:guardian
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_consciousness_allowed
  input:
    subject: lukhas:svc:consciousness
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Unknown service account
