module: core.filesystem
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_LukhasPathManager_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - filesystem.read
    - filesystem.write
    - filesystem.admin
    action: LukhasPathManager() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for LukhasPathManager() -> bool
- name: guest_paths_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: paths() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for paths() -> bool
- name: guest_get_lukhas_root_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'get_lukhas_root(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for get_lukhas_root(id: str) -> dict'
- name: guest_ensure_lukhas_structure_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ensure_lukhas_structure() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for ensure_lukhas_structure() -> bool
- name: guest_migrate_deprecated_path_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: migrate_deprecated_path() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for migrate_deprecated_path() -> bool
- name: visitor_LukhasPathManager_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: LukhasPathManager() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for LukhasPathManager() -> bool
- name: visitor_paths_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: paths() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for paths() -> bool
- name: visitor_get_lukhas_root_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'get_lukhas_root(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for get_lukhas_root(id: str) -> dict'
- name: visitor_ensure_lukhas_structure_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ensure_lukhas_structure() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for ensure_lukhas_structure() -> bool
- name: visitor_migrate_deprecated_path_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: migrate_deprecated_path() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for migrate_deprecated_path() -> bool
- name: friend_LukhasPathManager_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: LukhasPathManager() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for LukhasPathManager() -> bool
- name: friend_paths_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: paths() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for paths() -> bool
- name: friend_get_lukhas_root_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'get_lukhas_root(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier friend denied for get_lukhas_root(id: str) -> dict'
- name: friend_ensure_lukhas_structure_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ensure_lukhas_structure() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for ensure_lukhas_structure() -> bool
- name: friend_migrate_deprecated_path_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: migrate_deprecated_path() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for migrate_deprecated_path() -> bool
- name: trusted_LukhasPathManager_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: LukhasPathManager() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for LukhasPathManager() -> bool
- name: trusted_paths_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: paths() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for paths() -> bool
- name: trusted_get_lukhas_root_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'get_lukhas_root(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier trusted denied for get_lukhas_root(id: str) -> dict'
- name: trusted_ensure_lukhas_structure_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ensure_lukhas_structure() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for ensure_lukhas_structure() -> bool
- name: trusted_migrate_deprecated_path_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: migrate_deprecated_path() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for migrate_deprecated_path() -> bool
- name: inner_circle_LukhasPathManager_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: LukhasPathManager() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for LukhasPathManager() -> bool
- name: inner_circle_paths_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: paths() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for paths() -> bool
- name: inner_circle_get_lukhas_root_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'get_lukhas_root(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for get_lukhas_root(id: str) -> dict'
- name: inner_circle_ensure_lukhas_structure_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ensure_lukhas_structure() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for ensure_lukhas_structure() -> bool
- name: inner_circle_migrate_deprecated_path_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: migrate_deprecated_path() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for migrate_deprecated_path() -> bool
- name: root_dev_LukhasPathManager_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: LukhasPathManager() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for LukhasPathManager() -> bool
- name: root_dev_paths_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: paths() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for paths() -> bool
- name: root_dev_get_lukhas_root_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'get_lukhas_root(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for get_lukhas_root(id: str) -> dict'
- name: root_dev_ensure_lukhas_structure_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ensure_lukhas_structure() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for ensure_lukhas_structure() -> bool
- name: root_dev_migrate_deprecated_path_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: migrate_deprecated_path() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for migrate_deprecated_path() -> bool
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_guardian_allowed
  input:
    subject: lukhas:svc:guardian
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_consciousness_allowed
  input:
    subject: lukhas:svc:consciousness
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Unknown service account
