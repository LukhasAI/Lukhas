module: observability
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_LUKHASTracer_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - observability.read
    action: LUKHASTracer() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for LUKHASTracer() -> bool
- name: guest_initialize_tracing_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: initialize_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for initialize_tracing() -> bool
- name: guest_get_lukhas_tracer_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'get_lukhas_tracer(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for get_lukhas_tracer(id: str) -> dict'
- name: guest_shutdown_tracing_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: shutdown_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for shutdown_tracing() -> bool
- name: guest_trace_function_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: trace_function() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for trace_function() -> bool
- name: guest_trace_memory_recall_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'trace_memory_recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for trace_memory_recall(query: str, k: int) -> list[str]'
- name: guest_trace_matriz_execution_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: trace_matriz_execution() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for trace_matriz_execution() -> bool
- name: guest_LUKHASMetrics_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: LUKHASMetrics() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for LUKHASMetrics() -> bool
- name: guest_MetricsConfig_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: MetricsConfig() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for MetricsConfig() -> bool
- name: visitor_LUKHASTracer_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: LUKHASTracer() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for LUKHASTracer() -> bool
- name: visitor_initialize_tracing_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: initialize_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for initialize_tracing() -> bool
- name: visitor_get_lukhas_tracer_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'get_lukhas_tracer(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for get_lukhas_tracer(id: str) -> dict'
- name: visitor_shutdown_tracing_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: shutdown_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for shutdown_tracing() -> bool
- name: visitor_trace_function_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: trace_function() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for trace_function() -> bool
- name: visitor_trace_memory_recall_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'trace_memory_recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for trace_memory_recall(query: str, k: int) -> list[str]'
- name: visitor_trace_matriz_execution_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: trace_matriz_execution() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for trace_matriz_execution() -> bool
- name: visitor_LUKHASMetrics_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: LUKHASMetrics() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for LUKHASMetrics() -> bool
- name: visitor_MetricsConfig_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: MetricsConfig() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for MetricsConfig() -> bool
- name: friend_LUKHASTracer_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: LUKHASTracer() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for LUKHASTracer() -> bool
- name: friend_initialize_tracing_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: initialize_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for initialize_tracing() -> bool
- name: friend_get_lukhas_tracer_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'get_lukhas_tracer(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for get_lukhas_tracer(id: str) -> dict'
- name: friend_shutdown_tracing_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: shutdown_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for shutdown_tracing() -> bool
- name: friend_trace_function_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: trace_function() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for trace_function() -> bool
- name: friend_trace_memory_recall_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'trace_memory_recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for trace_memory_recall(query: str, k: int) -> list[str]'
- name: friend_trace_matriz_execution_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: trace_matriz_execution() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for trace_matriz_execution() -> bool
- name: friend_LUKHASMetrics_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: LUKHASMetrics() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for LUKHASMetrics() -> bool
- name: friend_MetricsConfig_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: MetricsConfig() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for MetricsConfig() -> bool
- name: trusted_LUKHASTracer_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: LUKHASTracer() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for LUKHASTracer() -> bool
- name: trusted_initialize_tracing_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: initialize_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for initialize_tracing() -> bool
- name: trusted_get_lukhas_tracer_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'get_lukhas_tracer(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for get_lukhas_tracer(id: str) -> dict'
- name: trusted_shutdown_tracing_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: shutdown_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for shutdown_tracing() -> bool
- name: trusted_trace_function_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: trace_function() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for trace_function() -> bool
- name: trusted_trace_memory_recall_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'trace_memory_recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for trace_memory_recall(query: str, k: int) -> list[str]'
- name: trusted_trace_matriz_execution_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: trace_matriz_execution() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for trace_matriz_execution() -> bool
- name: trusted_LUKHASMetrics_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: LUKHASMetrics() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for LUKHASMetrics() -> bool
- name: trusted_MetricsConfig_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: MetricsConfig() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for MetricsConfig() -> bool
- name: inner_circle_LUKHASTracer_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: LUKHASTracer() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for LUKHASTracer() -> bool
- name: inner_circle_initialize_tracing_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: initialize_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for initialize_tracing() -> bool
- name: inner_circle_get_lukhas_tracer_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'get_lukhas_tracer(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for get_lukhas_tracer(id: str) -> dict'
- name: inner_circle_shutdown_tracing_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: shutdown_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for shutdown_tracing() -> bool
- name: inner_circle_trace_function_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: trace_function() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for trace_function() -> bool
- name: inner_circle_trace_memory_recall_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'trace_memory_recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for trace_memory_recall(query: str, k: int) ->
    list[str]'
- name: inner_circle_trace_matriz_execution_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: trace_matriz_execution() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for trace_matriz_execution() -> bool
- name: inner_circle_LUKHASMetrics_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: LUKHASMetrics() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for LUKHASMetrics() -> bool
- name: inner_circle_MetricsConfig_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: MetricsConfig() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for MetricsConfig() -> bool
- name: root_dev_LUKHASTracer_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: LUKHASTracer() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for LUKHASTracer() -> bool
- name: root_dev_initialize_tracing_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: initialize_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for initialize_tracing() -> bool
- name: root_dev_get_lukhas_tracer_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'get_lukhas_tracer(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for get_lukhas_tracer(id: str) -> dict'
- name: root_dev_shutdown_tracing_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: shutdown_tracing() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for shutdown_tracing() -> bool
- name: root_dev_trace_function_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: trace_function() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for trace_function() -> bool
- name: root_dev_trace_memory_recall_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'trace_memory_recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for trace_memory_recall(query: str, k: int) -> list[str]'
- name: root_dev_trace_matriz_execution_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: trace_matriz_execution() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for trace_matriz_execution() -> bool
- name: root_dev_LUKHASMetrics_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: LUKHASMetrics() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for LUKHASMetrics() -> bool
- name: root_dev_MetricsConfig_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: MetricsConfig() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for MetricsConfig() -> bool
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - observability.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Unknown service account
