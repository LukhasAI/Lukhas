module: governance.identity
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_IdentityClient_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - identity.read
    - identity.write
    - identity.admin
    action: IdentityClient() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for IdentityClient() -> bool
- name: guest_IdentityImportBridge_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: IdentityImportBridge() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for IdentityImportBridge() -> bool
- name: guest_auth_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: auth() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for auth() -> bool
- name: guest_auth_integration_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: auth_integration() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for auth_integration() -> bool
- name: guest_auth_service_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: auth_service() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for auth_service() -> bool
- name: guest_get_identity_client_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'get_identity_client(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for get_identity_client(id: str) -> dict'
- name: guest_lambda_id_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: lambda_id() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for lambda_id() -> bool
- name: guest_passkey_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for passkey() -> bool
- name: guest_register_passkey_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: register_passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for register_passkey() -> bool
- name: visitor_IdentityClient_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: IdentityClient() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for IdentityClient() -> bool
- name: visitor_IdentityImportBridge_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: IdentityImportBridge() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for IdentityImportBridge() -> bool
- name: visitor_auth_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: auth() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for auth() -> bool
- name: visitor_auth_integration_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: auth_integration() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for auth_integration() -> bool
- name: visitor_auth_service_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: auth_service() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for auth_service() -> bool
- name: visitor_get_identity_client_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'get_identity_client(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for get_identity_client(id: str) -> dict'
- name: visitor_lambda_id_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: lambda_id() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for lambda_id() -> bool
- name: visitor_passkey_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for passkey() -> bool
- name: visitor_register_passkey_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: register_passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for register_passkey() -> bool
- name: friend_IdentityClient_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: IdentityClient() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for IdentityClient() -> bool
- name: friend_IdentityImportBridge_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: IdentityImportBridge() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for IdentityImportBridge() -> bool
- name: friend_auth_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: auth() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for auth() -> bool
- name: friend_auth_integration_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: auth_integration() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for auth_integration() -> bool
- name: friend_auth_service_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: auth_service() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for auth_service() -> bool
- name: friend_get_identity_client_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'get_identity_client(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier friend denied for get_identity_client(id: str) -> dict'
- name: friend_lambda_id_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: lambda_id() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for lambda_id() -> bool
- name: friend_passkey_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for passkey() -> bool
- name: friend_register_passkey_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: register_passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for register_passkey() -> bool
- name: trusted_IdentityClient_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: IdentityClient() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for IdentityClient() -> bool
- name: trusted_IdentityImportBridge_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: IdentityImportBridge() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for IdentityImportBridge() -> bool
- name: trusted_auth_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: auth() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for auth() -> bool
- name: trusted_auth_integration_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: auth_integration() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for auth_integration() -> bool
- name: trusted_auth_service_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: auth_service() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for auth_service() -> bool
- name: trusted_get_identity_client_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'get_identity_client(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier trusted denied for get_identity_client(id: str) -> dict'
- name: trusted_lambda_id_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: lambda_id() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for lambda_id() -> bool
- name: trusted_passkey_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for passkey() -> bool
- name: trusted_register_passkey_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: register_passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier trusted denied for register_passkey() -> bool
- name: inner_circle_IdentityClient_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: IdentityClient() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for IdentityClient() -> bool
- name: inner_circle_IdentityImportBridge_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: IdentityImportBridge() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for IdentityImportBridge() -> bool
- name: inner_circle_auth_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: auth() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for auth() -> bool
- name: inner_circle_auth_integration_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: auth_integration() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for auth_integration() -> bool
- name: inner_circle_auth_service_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: auth_service() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for auth_service() -> bool
- name: inner_circle_get_identity_client_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'get_identity_client(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for get_identity_client(id: str) -> dict'
- name: inner_circle_lambda_id_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: lambda_id() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for lambda_id() -> bool
- name: inner_circle_passkey_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for passkey() -> bool
- name: inner_circle_register_passkey_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: register_passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for register_passkey() -> bool
- name: root_dev_IdentityClient_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: IdentityClient() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for IdentityClient() -> bool
- name: root_dev_IdentityImportBridge_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: IdentityImportBridge() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for IdentityImportBridge() -> bool
- name: root_dev_auth_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: auth() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for auth() -> bool
- name: root_dev_auth_integration_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: auth_integration() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for auth_integration() -> bool
- name: root_dev_auth_service_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: auth_service() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for auth_service() -> bool
- name: root_dev_get_identity_client_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'get_identity_client(id: str) -> dict'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for get_identity_client(id: str) -> dict'
- name: root_dev_lambda_id_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: lambda_id() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for lambda_id() -> bool
- name: root_dev_passkey_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for passkey() -> bool
- name: root_dev_register_passkey_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: register_passkey() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for register_passkey() -> bool
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_guardian_allowed
  input:
    subject: lukhas:svc:guardian
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_consciousness_allowed
  input:
    subject: lukhas:svc:consciousness
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Unknown service account
