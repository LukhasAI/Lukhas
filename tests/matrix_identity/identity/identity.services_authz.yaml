module: identity.services
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_TokenService_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - services.read
    - services.write
    action: TokenService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for TokenService() -> bool
- name: guest_SessionService_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: SessionService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for SessionService() -> bool
- name: guest_Session_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: Session() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for Session() -> bool
- name: guest_PasswordAuthenticator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: PasswordAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for PasswordAuthenticator() -> bool
- name: guest_ApiKeyAuthenticator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: ApiKeyAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for ApiKeyAuthenticator() -> bool
- name: guest_UserCredentials_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: UserCredentials() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for UserCredentials() -> bool
- name: guest_create_password_authenticator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'create_password_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for create_password_authenticator(params: dict) -> str'
- name: guest_create_api_key_authenticator_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'create_api_key_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for create_api_key_authenticator(params: dict) -> str'
- name: visitor_TokenService_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: TokenService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for TokenService() -> bool
- name: visitor_SessionService_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: SessionService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for SessionService() -> bool
- name: visitor_Session_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: Session() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for Session() -> bool
- name: visitor_PasswordAuthenticator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: PasswordAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for PasswordAuthenticator() -> bool
- name: visitor_ApiKeyAuthenticator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: ApiKeyAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for ApiKeyAuthenticator() -> bool
- name: visitor_UserCredentials_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: UserCredentials() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for UserCredentials() -> bool
- name: visitor_create_password_authenticator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'create_password_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for create_password_authenticator(params: dict) ->
    str'
- name: visitor_create_api_key_authenticator_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'create_api_key_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for create_api_key_authenticator(params: dict) -> str'
- name: friend_TokenService_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: TokenService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for TokenService() -> bool
- name: friend_SessionService_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: SessionService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for SessionService() -> bool
- name: friend_Session_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: Session() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for Session() -> bool
- name: friend_PasswordAuthenticator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: PasswordAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for PasswordAuthenticator() -> bool
- name: friend_ApiKeyAuthenticator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: ApiKeyAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for ApiKeyAuthenticator() -> bool
- name: friend_UserCredentials_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: UserCredentials() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier friend denied for UserCredentials() -> bool
- name: friend_create_password_authenticator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'create_password_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier friend denied for create_password_authenticator(params: dict) -> str'
- name: friend_create_api_key_authenticator_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'create_api_key_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier friend denied for create_api_key_authenticator(params: dict) -> str'
- name: trusted_TokenService_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: TokenService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for TokenService() -> bool
- name: trusted_SessionService_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: SessionService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for SessionService() -> bool
- name: trusted_Session_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: Session() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for Session() -> bool
- name: trusted_PasswordAuthenticator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: PasswordAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for PasswordAuthenticator() -> bool
- name: trusted_ApiKeyAuthenticator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: ApiKeyAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for ApiKeyAuthenticator() -> bool
- name: trusted_UserCredentials_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: UserCredentials() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for UserCredentials() -> bool
- name: trusted_create_password_authenticator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'create_password_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier trusted allowed for create_password_authenticator(params: dict) ->
    str'
- name: trusted_create_api_key_authenticator_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'create_api_key_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier trusted allowed for create_api_key_authenticator(params: dict) ->
    str'
- name: inner_circle_TokenService_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: TokenService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for TokenService() -> bool
- name: inner_circle_SessionService_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: SessionService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for SessionService() -> bool
- name: inner_circle_Session_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: Session() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for Session() -> bool
- name: inner_circle_PasswordAuthenticator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: PasswordAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for PasswordAuthenticator() -> bool
- name: inner_circle_ApiKeyAuthenticator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: ApiKeyAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for ApiKeyAuthenticator() -> bool
- name: inner_circle_UserCredentials_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: UserCredentials() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for UserCredentials() -> bool
- name: inner_circle_create_password_authenticator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'create_password_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for create_password_authenticator(params: dict)
    -> str'
- name: inner_circle_create_api_key_authenticator_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'create_api_key_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for create_api_key_authenticator(params: dict)
    -> str'
- name: root_dev_TokenService_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: TokenService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for TokenService() -> bool
- name: root_dev_SessionService_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: SessionService() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for SessionService() -> bool
- name: root_dev_Session_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: Session() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for Session() -> bool
- name: root_dev_PasswordAuthenticator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: PasswordAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for PasswordAuthenticator() -> bool
- name: root_dev_ApiKeyAuthenticator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: ApiKeyAuthenticator() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for ApiKeyAuthenticator() -> bool
- name: root_dev_UserCredentials_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: UserCredentials() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for UserCredentials() -> bool
- name: root_dev_create_password_authenticator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'create_password_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for create_password_authenticator(params: dict) ->
    str'
- name: root_dev_create_api_key_authenticator_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'create_api_key_authenticator(params: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for create_api_key_authenticator(params: dict) ->
    str'
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - services.read
    action: read
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Unknown service account
