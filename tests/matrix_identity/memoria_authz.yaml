module: memoria
generated: auto-generated by matrix_test_generator.py
test_cases:
- name: guest_FoldManager_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: &id001
    - memory.read
    - memory.write
    action: 'FoldManager(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for FoldManager(memories: list[str]) -> str'
- name: guest_MemoryFold_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'MemoryFold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for MemoryFold(memories: list[str]) -> str'
- name: guest_MemoryFoldSystem_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'MemoryFoldSystem(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for MemoryFoldSystem(memories: list[str]) -> str'
- name: guest_MemoryMatrizAdapter_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: MemoryMatrizAdapter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for MemoryMatrizAdapter() -> bool
- name: guest_MemoryWrapper_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: MemoryWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for MemoryWrapper() -> bool
- name: guest_access_memory_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: access_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for access_memory() -> bool
- name: guest_consolidate_memory_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: consolidate_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for consolidate_memory() -> bool
- name: guest_create_fold_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: 'create_fold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier guest denied for create_fold(memories: list[str]) -> str'
- name: guest_dump_state_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes: *id001
    action: dump_state() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier guest denied for dump_state() -> bool
- name: visitor_FoldManager_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'FoldManager(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for FoldManager(memories: list[str]) -> str'
- name: visitor_MemoryFold_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'MemoryFold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for MemoryFold(memories: list[str]) -> str'
- name: visitor_MemoryFoldSystem_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'MemoryFoldSystem(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for MemoryFoldSystem(memories: list[str]) -> str'
- name: visitor_MemoryMatrizAdapter_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: MemoryMatrizAdapter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for MemoryMatrizAdapter() -> bool
- name: visitor_MemoryWrapper_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: MemoryWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for MemoryWrapper() -> bool
- name: visitor_access_memory_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: access_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for access_memory() -> bool
- name: visitor_consolidate_memory_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: consolidate_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for consolidate_memory() -> bool
- name: visitor_create_fold_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: 'create_fold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier visitor denied for create_fold(memories: list[str]) -> str'
- name: visitor_dump_state_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes: *id001
    action: dump_state() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier visitor denied for dump_state() -> bool
- name: friend_FoldManager_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'FoldManager(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for FoldManager(memories: list[str]) -> str'
- name: friend_MemoryFold_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'MemoryFold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for MemoryFold(memories: list[str]) -> str'
- name: friend_MemoryFoldSystem_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'MemoryFoldSystem(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for MemoryFoldSystem(memories: list[str]) -> str'
- name: friend_MemoryMatrizAdapter_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: MemoryMatrizAdapter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for MemoryMatrizAdapter() -> bool
- name: friend_MemoryWrapper_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: MemoryWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for MemoryWrapper() -> bool
- name: friend_access_memory_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: access_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for access_memory() -> bool
- name: friend_consolidate_memory_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: consolidate_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for consolidate_memory() -> bool
- name: friend_create_fold_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: 'create_fold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: 'Tier friend denied for create_fold(memories: list[str]) -> str'
- name: friend_dump_state_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes: *id001
    action: dump_state() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Tier friend denied for dump_state() -> bool
- name: trusted_FoldManager_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'FoldManager(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for FoldManager(memories: list[str]) -> str'
- name: trusted_MemoryFold_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'MemoryFold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for MemoryFold(memories: list[str]) -> str'
- name: trusted_MemoryFoldSystem_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: 'MemoryFoldSystem(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for MemoryFoldSystem(memories: list[str]) -> str'
- name: trusted_MemoryMatrizAdapter_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: MemoryMatrizAdapter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for MemoryMatrizAdapter() -> bool
- name: trusted_MemoryWrapper_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: MemoryWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for MemoryWrapper() -> bool
- name: trusted_access_memory_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: access_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for access_memory() -> bool
- name: trusted_consolidate_memory_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: consolidate_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for consolidate_memory() -> bool
- name: trusted_create_fold_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memory.read
    - memory.write
    - memory.fold
    action: 'create_fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: false
  expected: true
  reason: 'Tier trusted allowed for create_fold(memories: list[str]) -> str with MFA'
- name: trusted_dump_state_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: dump_state() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier trusted allowed for dump_state() -> bool
- name: inner_circle_FoldManager_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'FoldManager(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for FoldManager(memories: list[str]) -> str'
- name: inner_circle_MemoryFold_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'MemoryFold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for MemoryFold(memories: list[str]) -> str'
- name: inner_circle_MemoryFoldSystem_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: 'MemoryFoldSystem(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for MemoryFoldSystem(memories: list[str]) ->
    str'
- name: inner_circle_MemoryMatrizAdapter_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: MemoryMatrizAdapter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for MemoryMatrizAdapter() -> bool
- name: inner_circle_MemoryWrapper_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: MemoryWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for MemoryWrapper() -> bool
- name: inner_circle_access_memory_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: access_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for access_memory() -> bool
- name: inner_circle_consolidate_memory_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: consolidate_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for consolidate_memory() -> bool
- name: inner_circle_create_fold_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes:
    - memory.read
    - memory.write
    - memory.fold
    action: 'create_fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: false
  expected: true
  reason: 'Tier inner_circle allowed for create_fold(memories: list[str]) -> str with
    MFA'
- name: inner_circle_dump_state_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes: *id001
    action: dump_state() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier inner_circle allowed for dump_state() -> bool
- name: root_dev_FoldManager_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'FoldManager(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for FoldManager(memories: list[str]) -> str'
- name: root_dev_MemoryFold_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'MemoryFold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for MemoryFold(memories: list[str]) -> str'
- name: root_dev_MemoryFoldSystem_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: 'MemoryFoldSystem(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for MemoryFoldSystem(memories: list[str]) -> str'
- name: root_dev_MemoryMatrizAdapter_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: MemoryMatrizAdapter() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for MemoryMatrizAdapter() -> bool
- name: root_dev_MemoryWrapper_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: MemoryWrapper() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for MemoryWrapper() -> bool
- name: root_dev_access_memory_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: access_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for access_memory() -> bool
- name: root_dev_consolidate_memory_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: consolidate_memory() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for consolidate_memory() -> bool
- name: root_dev_create_fold_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes:
    - memory.read
    - memory.write
    - memory.fold
    action: 'create_fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: false
  expected: true
  reason: 'Tier root_dev allowed for create_fold(memories: list[str]) -> str with
    MFA'
- name: root_dev_dump_state_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: dump_state() -> bool
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Tier root_dev allowed for dump_state() -> bool
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memory.read
    action: read
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1658892261
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: *id001
    action: read
    token:
      exp: 1758894061
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes: *id001
    action: process
    env:
      mfa: false
      webauthn_verified: false
  expected: false
  reason: Unknown service account
