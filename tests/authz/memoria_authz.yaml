module: memoria
generated: auto-generated by generate_authz_matrix.py
test_cases:
- name: 'guest_recall(query: str, k: int) -> list[str]_basic'
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes:
    - memoria.read
    - memoria.store
    action: 'recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for recall(query: str, k: int) -> list[str]'
- name: 'guest_store(content: str, metadata: dict) -> str_basic'
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes:
    - memoria.read
    - memoria.store
    action: 'store(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for store(content: str, metadata: dict) -> str'
- name: 'guest_fold(memories: list[str]) -> str_basic'
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes:
    - memoria.read
    - memoria.store
    action: 'fold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier guest denied for fold(memories: list[str]) -> str'
- name: guest_cascade_prevent() -> bool_basic
  input:
    subject: lukhas:user:test_guest
    tier: guest
    tier_num: 0
    scopes:
    - memoria.read
    - memoria.store
    action: cascade_prevent() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier guest denied for cascade_prevent() -> bool
- name: 'visitor_recall(query: str, k: int) -> list[str]_basic'
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes:
    - memoria.read
    - memoria.store
    action: 'recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for recall(query: str, k: int) -> list[str]'
- name: 'visitor_store(content: str, metadata: dict) -> str_basic'
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes:
    - memoria.read
    - memoria.store
    action: 'store(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for store(content: str, metadata: dict) -> str'
- name: 'visitor_fold(memories: list[str]) -> str_basic'
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes:
    - memoria.read
    - memoria.store
    action: 'fold(memories: list[str]) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: 'Tier visitor denied for fold(memories: list[str]) -> str'
- name: visitor_cascade_prevent() -> bool_basic
  input:
    subject: lukhas:user:test_visitor
    tier: visitor
    tier_num: 1
    scopes:
    - memoria.read
    - memoria.store
    action: cascade_prevent() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Tier visitor denied for cascade_prevent() -> bool
- name: 'friend_recall(query: str, k: int) -> list[str]_basic'
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes:
    - memoria.read
    - memoria.store
    action: 'recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier friend allowed for recall(query: str, k: int) -> list[str]'
- name: 'friend_store(content: str, metadata: dict) -> str_basic'
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes:
    - memoria.read
    - memoria.store
    action: 'store(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier friend allowed for store(content: str, metadata: dict) -> str'
- name: 'friend_fold(memories: list[str]) -> str_basic'
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes:
    - memoria.read
    - memoria.store
    - memoria.fold
    action: 'fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: true
  expected: true
  reason: 'Tier friend allowed for fold(memories: list[str]) -> str with MFA'
- name: friend_cascade_prevent() -> bool_basic
  input:
    subject: lukhas:user:test_friend
    tier: friend
    tier_num: 2
    scopes:
    - memoria.read
    - memoria.store
    action: cascade_prevent() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier friend allowed for cascade_prevent() -> bool
- name: 'trusted_recall(query: str, k: int) -> list[str]_basic'
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    - memoria.store
    action: 'recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier trusted allowed for recall(query: str, k: int) -> list[str]'
- name: 'trusted_store(content: str, metadata: dict) -> str_basic'
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    - memoria.store
    action: 'store(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier trusted allowed for store(content: str, metadata: dict) -> str'
- name: 'trusted_fold(memories: list[str]) -> str_basic'
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    - memoria.store
    - memoria.fold
    action: 'fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: true
  expected: true
  reason: 'Tier trusted allowed for fold(memories: list[str]) -> str with MFA'
- name: trusted_cascade_prevent() -> bool_basic
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    - memoria.store
    action: cascade_prevent() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier trusted allowed for cascade_prevent() -> bool
- name: 'inner_circle_recall(query: str, k: int) -> list[str]_basic'
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes:
    - memoria.read
    - memoria.store
    action: 'recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for recall(query: str, k: int) -> list[str]'
- name: 'inner_circle_store(content: str, metadata: dict) -> str_basic'
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes:
    - memoria.read
    - memoria.store
    action: 'store(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for store(content: str, metadata: dict) -> str'
- name: 'inner_circle_fold(memories: list[str]) -> str_basic'
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes:
    - memoria.read
    - memoria.store
    - memoria.fold
    action: 'fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: true
  expected: true
  reason: 'Tier inner_circle allowed for fold(memories: list[str]) -> str with MFA'
- name: inner_circle_cascade_prevent() -> bool_basic
  input:
    subject: lukhas:user:test_inner_circle
    tier: inner_circle
    tier_num: 4
    scopes:
    - memoria.read
    - memoria.store
    action: cascade_prevent() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier inner_circle allowed for cascade_prevent() -> bool
- name: 'root_dev_recall(query: str, k: int) -> list[str]_basic'
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes:
    - memoria.read
    - memoria.store
    action: 'recall(query: str, k: int) -> list[str]'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for recall(query: str, k: int) -> list[str]'
- name: 'root_dev_store(content: str, metadata: dict) -> str_basic'
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes:
    - memoria.read
    - memoria.store
    action: 'store(content: str, metadata: dict) -> str'
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for store(content: str, metadata: dict) -> str'
- name: 'root_dev_fold(memories: list[str]) -> str_basic'
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes:
    - memoria.read
    - memoria.store
    - memoria.fold
    action: 'fold(memories: list[str]) -> str'
    env:
      mfa: true
      webauthn_verified: true
  expected: true
  reason: 'Tier root_dev allowed for fold(memories: list[str]) -> str with MFA'
- name: root_dev_cascade_prevent() -> bool_basic
  input:
    subject: lukhas:user:test_root_dev
    tier: root_dev
    tier_num: 5
    scopes:
    - memoria.read
    - memoria.store
    action: cascade_prevent() -> bool
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Tier root_dev allowed for cascade_prevent() -> bool
- name: trusted_missing_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes: []
    action: read
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Missing required scopes
- name: trusted_partial_scopes
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    action: read
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Partial scopes provided
- name: trusted_expired_token
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    - memoria.store
    action: read
    token:
      exp: 1658892261  # Past expiry (2022)
      aud: lukhas-matrix
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Token expired
- name: trusted_wrong_audience
  input:
    subject: lukhas:user:test_trusted
    tier: trusted
    tier_num: 3
    scopes:
    - memoria.read
    - memoria.store
    action: read
    token:
      exp: 1758894061  # Future expiry
      aud: wrong-audience
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Wrong audience in token
- name: service_orchestrator_allowed
  input:
    subject: lukhas:svc:orchestrator
    tier: root_dev
    tier_num: 5
    scopes:
    - memoria.read
    - memoria.store
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: true
  reason: Service account in accepted subjects
- name: service_unknown_denied
  input:
    subject: lukhas:svc:unknown
    tier: root_dev
    tier_num: 5
    scopes:
    - memoria.read
    - memoria.store
    action: process
    env:
      mfa: false
      webauthn_verified: true
  expected: false
  reason: Unknown service account
