{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "lukhas:module.manifest.schema.json",
  "title": "LUKHAS Module Manifest",
  "type": "object",
  "required": ["schema_version", "module", "ownership", "layout", "links"],
  "additionalProperties": false,
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^[1-9]\\.[0-9]+\\.[0-9]+$",
      "description": "Schema version for this manifest format"
    },
    "module": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_\\.\\-]+$",
      "description": "Module name (alphanumeric, underscore, dot, hyphen)"
    },
    "description": {
      "type": "string",
      "description": "Human-readable module description"
    },
    "ownership": {
      "type": "object",
      "required": ["team", "codeowners"],
      "additionalProperties": false,
      "properties": {
        "team": {
          "type": "string",
          "description": "Owning team name"
        },
        "codeowners": {
          "type": "array",
          "items": { "type": "string" },
          "description": "GitHub usernames for code ownership"
        },
        "slack_channel": {
          "type": "string",
          "description": "Slack channel for team communication"
        }
      }
    },
    "layout": {
      "type": "object",
      "required": ["code_layout"],
      "additionalProperties": false,
      "properties": {
        "code_layout": {
          "type": "string",
          "enum": ["src-root", "package-root"],
          "description": "Code organization pattern"
        },
        "paths": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "code": {
              "type": "string",
              "description": "Relative path to source code"
            },
            "config": {
              "type": "string",
              "description": "Relative path to configuration files"
            },
            "tests": {
              "type": "string",
              "description": "Relative path to test files"
            },
            "docs": {
              "type": "string",
              "description": "Relative path to documentation"
            },
            "assets": {
              "type": "string",
              "description": "Relative path to assets/data files"
            }
          }
        }
      }
    },
    "runtime": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "language": {
          "type": "string",
          "enum": ["python", "typescript", "other"],
          "description": "Primary programming language"
        },
        "entrypoints": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Module entry points (import paths)"
        }
      }
    },
    "matrix": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "contract": {
          "type": "string",
          "description": "Path to MATRIZ contract file"
        },
        "lane": {
          "type": "string",
          "pattern": "^L[0-5]$",
          "description": "MATRIZ lane assignment (L0-L5)"
        },
        "gates_profile": {
          "type": "string",
          "enum": ["strict", "standard", "lenient"],
          "description": "Validation strictness profile"
        }
      }
    },
    "identity": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "requires_auth": {
          "type": "boolean",
          "description": "Whether module requires authentication"
        },
        "tiers": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Required authentication tiers"
        },
        "scopes": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Required OAuth scopes"
        }
      }
    },
    "links": {
      "type": "object",
      "required": ["repo", "docs", "issues"],
      "additionalProperties": false,
      "properties": {
        "repo": {
          "type": "string",
          "description": "Repository URL"
        },
        "docs": {
          "type": "string",
          "description": "Documentation URL or path"
        },
        "issues": {
          "type": "string",
          "description": "Issue tracker URL"
        },
        "sbom": {
          "type": "string",
          "description": "Software Bill of Materials path"
        }
      }
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Categorization tags"
    },
    "observability": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "required_spans": {
          "type": "array",
          "items": { "type": "string" },
          "description": "OpenTelemetry spans that must be present"
        },
        "otel_semconv_version": {
          "type": "string",
          "description": "OpenTelemetry semantic conventions version"
        }
      }
    },
    "tokenization": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether tokenization is enabled"
        },
        "chain": {
          "type": "string",
          "enum": ["solana", "evm", "none"],
          "description": "Blockchain platform"
        },
        "asset_id": {
          "type": "string",
          "description": "Token asset identifier"
        },
        "proof_uri": {
          "type": "string",
          "description": "URI to tokenization proof"
        }
      }
    },
    "dependencies": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Module dependencies (other modules)"
    },
    "contracts": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Paths to contract files"
    },
    "x_legacy": {
      "type": "object",
      "description": "Legacy data preserved during migration (for rollback capability)"
    }
  }
}