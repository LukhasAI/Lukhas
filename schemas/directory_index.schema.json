{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "lukhas://schemas/directory_index.schema.json",
  "title": "LUKHAS Directory Index Schema v3.0.0",
  "description": "Machine-readable directory index for AI agent discovery and coordination with Constellation Framework and MATRIZ pipeline integration",
  "type": "object",
  "required": [
    "schema_version",
    "directory_metadata",
    "component_inventory",
    "agent_guidance"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "const": "3.0.0"
    },
    "directory_metadata": {
      "type": "object",
      "required": ["path", "lane", "purpose", "last_updated"],
      "properties": {
        "path": {
          "type": "string",
          "description": "Relative path from LUKHAS root"
        },
        "lane": {
          "type": "string",
          "enum": ["production", "integration", "development"],
          "description": "Lane position in consciousness evolution"
        },
        "purpose": {
          "type": "string",
          "description": "Primary purpose of this directory"
        },
        "constellation_framework_version": {
          "type": "string",
          "const": "2.0.0",
          "description": "Constellation Framework version"
        },
        "constellation_role": {
          "type": "string",
          "enum": [
            "anchor_star_primary", "anchor_star_secondary",
            "trail_star_primary", "trail_star_secondary",
            "horizon_star_primary", "horizon_star_secondary",
            "watch_star_primary", "watch_star_secondary"
          ],
          "description": "Constellation Framework star role"
        },
        "t4_compliance_level": {
          "type": "string",
          "enum": ["experimental", "integration", "production"],
          "description": "T4/0.01% implementation compliance level"
        },
        "matriz_pipeline_integration": {
          "type": "object",
          "properties": {
            "memory_stage": {
              "type": "string",
              "enum": ["inactive", "experimental", "supporting", "active", "primary"]
            },
            "attention_stage": {
              "type": "string",
              "enum": ["inactive", "experimental", "supporting", "active", "primary"]
            },
            "thought_stage": {
              "type": "string",
              "enum": ["inactive", "experimental", "supporting", "active", "primary"]
            },
            "action_stage": {
              "type": "string",
              "enum": ["inactive", "experimental", "supporting", "active", "primary"]
            },
            "decision_stage": {
              "type": "string",
              "enum": ["inactive", "experimental", "supporting", "active", "primary"]
            },
            "awareness_stage": {
              "type": "string",
              "enum": ["inactive", "experimental", "supporting", "active", "primary"]
            }
          },
          "description": "MATRIZ pipeline stage integration levels"
        },
        "last_updated": {
          "type": "string",
          "format": "date"
        }
      }
    },
    "component_inventory": {
      "type": "object",
      "properties": {
        "python_files": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["filename", "component_type"],
            "properties": {
              "filename": {"type": "string"},
              "component_type": {
                "type": "string",
                "enum": [
                  "CONSCIOUSNESS_ENGINE", "COGNITIVE_PROCESSOR", "REFLECTION_SYSTEM",
                  "AWARENESS_MODULE", "DECISION_MAKER", "EMOTION_PROCESSOR",
                  "MEMORY_INTERFACE", "CONSTELLATION_BRIDGE", "CONSTELLATION_CORE",
                  "CONSTELLATION_SERVICE", "MATRIZ_PROCESSOR", "ORCHESTRATION_NODE",
                  "SYMBOLIC_PROCESSOR", "CREATIVITY_ENGINE", "DREAM_PROCESSOR",
                  "IDENTITY_SERVICE", "GUARDIAN_VALIDATOR", "API_INTERFACE",
                  "DATA_MODEL", "UTILITY", "TEST", "CONFIGURATION"
                ]
              },
              "has_contract": {"type": "boolean"},
              "contract_path": {"type": ["string", "null"]},
              "dependencies": {
                "type": "array",
                "items": {"type": "string"}
              },
              "exports": {
                "type": "array",
                "items": {"type": "string"}
              }
            }
          }
        },
        "subdirectories": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "has_index"],
            "properties": {
              "name": {"type": "string"},
              "has_index": {"type": "boolean"},
              "purpose": {"type": ["string", "null"]},
              "component_count": {"type": "integer"}
            }
          }
        },
        "documentation": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["filename", "type"],
            "properties": {
              "filename": {"type": "string"},
              "type": {
                "type": "string",
                "enum": ["claude.me", "lukhas_context.md", "README.md", "schema", "contract", "other"]
              },
              "has_sync_header": {"type": "boolean"}
            }
          }
        }
      }
    },
    "schema_references": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["schema_name", "schema_path"],
        "properties": {
          "schema_name": {"type": "string"},
          "schema_path": {"type": "string"},
          "validation_status": {
            "type": "string",
            "enum": ["valid", "invalid", "unknown"]
          }
        }
      }
    },
    "agent_guidance": {
      "type": "object",
      "required": ["recommended_approach", "key_files"],
      "properties": {
        "recommended_approach": {
          "type": "string",
          "description": "Guidance for AI agents working in this directory"
        },
        "key_files": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Most important files for agents to examine first"
        },
        "common_tasks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["task", "files_involved"],
            "properties": {
              "task": {"type": "string"},
              "files_involved": {
                "type": "array",
                "items": {"type": "string"}
              },
              "complexity": {
                "type": "string",
                "enum": ["low", "medium", "high"]
              }
            }
          }
        },
        "prerequisites": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Knowledge or dependencies required before working here"
        },
        "avoid_patterns": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Common mistakes or patterns to avoid"
        }
      }
    },
    "performance_metadata": {
      "type": "object",
      "properties": {
        "component_count": {"type": "integer"},
        "estimated_complexity": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"]
        },
        "consciousness_integration": {
          "type": "string",
          "enum": ["none", "basic", "intermediate", "advanced", "core"]
        },
        "test_coverage": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "t4_compliance_score": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "T4/0.01% compliance score"
        },
        "matriz_compatibility": {
          "type": "string",
          "enum": ["none", "experimental", "standard", "native"],
          "description": "MATRIZ pipeline compatibility level"
        },
        "plugin_registry_compatible": {
          "type": "boolean",
          "description": "Enhanced plugin registry compatibility"
        },
        "constructor_aware_instantiation": {
          "type": "boolean",
          "description": "Constructor-aware instantiation pattern support"
        }
      }
    },
    "relationships": {
      "type": "object",
      "properties": {
        "parent_directory": {"type": ["string", "null"]},
        "related_directories": {
          "type": "array",
          "items": {"type": "string"}
        },
        "constellation_cluster": {"type": "string"},
        "dependency_weight": {
          "type": "string",
          "enum": ["isolated", "light", "moderate", "heavy", "critical"]
        }
      }
    }
  }
}