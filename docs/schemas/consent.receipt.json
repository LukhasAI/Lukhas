{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schema.lukhas.ai/consent-receipt/1",
  "title": "LUKHAS Consent Receipt Schema",
  "description": "Cryptographically signed consent record for transparent data usage",
  "type": "object",
  "required": ["user_id", "scopes", "ts", "policy_version", "signature"],
  "properties": {
    "user_id": {
      "type": "string",
      "description": "User's Lambda ID",
      "pattern": "^LUKHAS[0-5]-[A-F0-9]{4}-[\\w\\p{So}]-[A-F0-9]{4}$",
      "examples": ["LUKHAS3-A4B7-Λ-C9F2", "LUKHAS1-B8E3-◊-F1A4"]
    },
    "scopes": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Specific data access permissions granted",
      "examples": [
        ["amazon.orders.read", "price.compare", "profile.preferences"],
        ["gmail.headers.read", "calendar.events.read"]
      ]
    },
    "ts": {
      "type": "integer",
      "description": "Consent timestamp (epoch milliseconds)",
      "minimum": 1640995200000
    },
    "policy_version": {
      "type": "string",
      "description": "Privacy policy version at time of consent",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.2.0", "2.1.3"]
    },
    "signature": {
      "type": "string",
      "description": "Cryptographic signature for integrity verification",
      "minLength": 32
    },
    "explanations": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Human-readable explanations of what each scope enables",
      "examples": [
        ["Access your Amazon order history for smart restocking reminders"],
        ["Read email headers to detect receipt patterns (content never accessed)"]
      ]
    },
    "expires_at": {
      "type": "integer",
      "description": "When consent expires (epoch milliseconds)",
      "minimum": 1640995200000
    },
    "revoked_at": {
      "type": "integer",
      "description": "When consent was revoked (if applicable)",
      "minimum": 1640995200000
    },
    "renewal_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of times this consent has been renewed"
    },
    "ip_address": {
      "type": "string",
      "description": "IP address from which consent was granted (for audit)"
    },
    "user_agent": {
      "type": "string",
      "description": "User agent string from consent session (for audit)"
    },
    "geolocation": {
      "type": "object",
      "description": "General location for regulatory compliance",
      "properties": {
        "country_code": {"type": "string", "pattern": "^[A-Z]{2}$"},
        "region": {"type": "string"},
        "regulatory_zone": {
          "type": "string", 
          "enum": ["GDPR", "CCPA", "PIPEDA", "LGPD", "POPIA", "OTHER"]
        }
      }
    },
    "consent_method": {
      "type": "string",
      "enum": ["explicit_click", "typed_agreement", "biometric_confirmation"],
      "description": "Method used to obtain consent"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "user_id": "LUKHAS3-A4B7-Λ-C9F2",
      "scopes": ["amazon.orders.read", "price.compare"],
      "ts": 1724880000000,
      "policy_version": "1.2.0",
      "signature": "sig_abc123def456789",
      "explanations": [
        "Access your Amazon order history for smart restocking reminders",
        "Compare prices across merchants to find you better deals"
      ],
      "expires_at": 1756416000000,
      "consent_method": "explicit_click",
      "geolocation": {
        "country_code": "US",
        "region": "California",
        "regulatory_zone": "CCPA"
      }
    }
  ]
}