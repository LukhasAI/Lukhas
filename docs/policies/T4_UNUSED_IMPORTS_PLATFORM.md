# T4 — Unused Imports Platform Policy (v1.0)

**Mission.** Transform F401 "unused import" findings in production lanes into structured, actionable, and governed technical intent.
T4 is a platform: annotations in code are the human-facing representation; the **Intent Registry** is the authoritative catalog.

## Scope
**Production lanes**: `lukhas/`, `core/`, `api/`, `consciousness/`, `memory/`, `identity/`, `MATRIZ/`  
**Excluded**: `candidate/`, `labs/`, `archive/`, `quarantine/`, `.venv/`, `node_modules/`, `.git/`, `reports/`

## Core concepts
- **Annotation**: a single-line JSON inline annotation on the import line with tag `TODO[T4-UNUSED-IMPORT]`.
- **Intent Registry**: a structured database (SQLite/JSONL) ingesting audit logs and inline annotations; source of truth for states and metrics.
- **Lifecycle**: `reserved` → `planned` (ticket) → `committed` (PR) → `implemented` (import used/annotation removed) → `expired` (abandoned).
- **Quality rules**: for `planned` and `committed`, `owner` and `ticket` required. All waivers must have TTL/expiry.

## Annotation schema (inline JSON)
**Example**:
```py
# TODO[T4-UNUSED-IMPORT]: {"id":"t4-9f1a2b3c","reason_category":"MATRIZ","reason":"MATRIZ-R2 trace routing","owner":"@ana","ticket":"GH-334","eta":"2025-12-01","status":"reserved","created_at":"2025-10-01T12:00:00Z"}
from MATRIZ.router import TraceRouter
```

### Fields

* `id` (string): unique id `t4-<hex>` (required)
* `reason_category` (string): one of `MATRIZ|CONSTELLATION|CORE_INFRA|API|BIO_QUANTUM|OTHER` (recommended)
* `reason` (string): human-friendly purpose (required)
* `owner` (string|null): GitHub handle (required for `planned/committed`)
* `ticket` (string|null): reference (e.g., `GH-334`) (required for `planned/committed`)
* `eta` (date|null): target implementation date (ISO `YYYY-MM-DD`)
* `status` (string): one of `reserved|planned|committed|implemented|expired` (required)
* `created_at` (ISO timestamp): generated by annotator (required)
* `modified_at` (ISO timestamp): updated when status changes (tool fills)

### Human rules

* Do not include secrets or sensitive data in `reason`.
* Avoid generic `reason` like "kept for future" — the validator will flag such entries.
* File-level waivers require `expires` in `AUDIT/waivers/unused_imports.yaml`.

## Tooling & automation

* **Annotator**: `tools/ci/unused_imports.py` writes structured inline JSON when annotating.
* **Validator**: `tools/ci/check_unused_imports_todo.py` parses inline JSON, enforces schema, and fails CI on violations.
* **Intent Registry**: `tools/ci/intent_registry.py` ingests `reports/todos/unused_imports.jsonl` into a SQLite DB and provides queries for stale items and metrics.
* **CI & pre-commit**: Pre-commit hooks propose quick-fixes and CI runs validator on PRs touching production lanes. PRs that add `status=reserved` without `owner` should create an issue or be blocked.

## Metrics

* **F401 elimination rate** (production lanes).
* **Annotation Quality Score**: % annotated with `owner`+`ticket`+`eta`.
* **Time-to-Implement**: average time `reserved` → `implemented`.
* **Stale annotations** (> 90 days).
* **Waiver usage**.

## Migration

1. Update annotator to write JSON-inline and preserve audit logs.
2. Ingest current `reports/todos/unused_imports.jsonl` into Intent Registry; normalize old free-text reasons into `status=reserved`.
3. Run validator in CI in `--json-only` or `--dry-run` for an initial observation window (2–4 weeks), then enable strict mode.
4. Monthly cleanup: convert generic reasons into tickets or expire them.

## Governance

* `reserved` defaults to a 30-day review. Owners must convert `reserved` → `planned` (with ticket) or mark as `expired`.
* File-level waivers must include `expires`.
* Architecture guild conducts monthly audits of T4 annotations.

## Operational guidance

* Start with **dry-run** for 2–4 weeks to collect data and tune the validator.
* Add `tools/ci/intent_registry.py` to the maintenance tasks and dashboard pipeline.
* Use the dashboard to prioritize high-impact `reserved` annotations to convert into work.

---

**Last Updated**: 2025-11-06  
**Maintainers**: LUKHAS AI Engineering / Architecture.
