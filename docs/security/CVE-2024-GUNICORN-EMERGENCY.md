---
status: wip
type: documentation
owner: unknown
module: security
redirect: false
moved_to: null
---

# Emergency Security Advisory: Gunicorn CVE-2024-6827 & CVE-2024-1135

**Date**: September 21, 2025
**Severity**: HIGH
**Affected Component**: Gunicorn WSGI HTTP Server
**Status**: PATCHED

## Executive Summary

LUKHAS AI platform was vulnerable to two HIGH SEVERITY security vulnerabilities in the Gunicorn WSGI HTTP server. These vulnerabilities have been **immediately patched** through emergency dependency updates.

## Affected Vulnerabilities

### CVE-2024-6827 (CVSS: 7.5 - HIGH)
- **Type**: HTTP Request/Response Smuggling
- **Impact**: Attackers can manipulate session data, poison caches, or compromise data integrity
- **Root Cause**: Improper validation of Transfer-Encoding header, fallback to Content-Length enables TE.CL request smuggling
- **Affected Version**: gunicorn 21.2.0
- **Fixed Version**: gunicorn 23.0.0+

### CVE-2024-1135 (CVSS: 8.2 - HIGH)
- **Type**: Request Smuggling Leading to Endpoint Restriction Bypass
- **Impact**: Bypass security restrictions and access restricted endpoints
- **Root Cause**: Improper handling of conflicting Transfer-Encoding headers
- **Affected Version**: gunicorn 21.2.0
- **Fixed Version**: gunicorn 23.0.0+

## Technical Details

Both vulnerabilities exploit Gunicorn's incorrect handling of Transfer-Encoding headers:

1. **CVE-2024-6827**: Gunicorn doesn't properly validate Transfer-Encoding header values per RFC standards, leading to fallback to Content-Length and enabling TE.CL request smuggling attacks.

2. **CVE-2024-1135**: Gunicorn incorrectly processes requests with multiple conflicting Transfer-Encoding headers, treating them as chunked regardless of the final encoding specified.

## Impact Assessment

**Risk Level**: HIGH - Production systems potentially vulnerable to:
- HTTP Request Smuggling attacks
- Session manipulation and cache poisoning
- Security control bypass
- Data integrity compromise

**Affected Systems**:
- Production LUKHAS AI deployments using gunicorn 21.2.0
- Identity governance services
- API endpoints exposed through gunicorn

## Remediation Actions Taken

### Immediate Response (Emergency Patch)
1. **Updated gunicorn from 21.2.0 â†’ 23.0.0** across all dependency files
2. **Updated SHA256 hashes** for secure installation verification
3. **Added security comments** to track the fix reasoning

### Files Updated
- `requirements-prod.in`: Updated gunicorn constraint to `>=23.0.0,<24.0.0`
- `requirements-prod.txt`: Updated pinned version with new SHA256 hashes
- `candidate/governance/identity/requirements.txt`: Updated minimum version requirement

### Hash Verification
```
gunicorn-23.0.0-py3-none-any.whl: sha256:ec400d38950de4dfd418cff8328b2c8faed0edb0d517d3394e457c317908ca4d
gunicorn-23.0.0.tar.gz: sha256:f014447a0101dc57e294f6c18ca6b40227a4c90e9bdb586042628030cba004ec
```

## Deployment Instructions

### For Production Systems
```bash
# Update dependencies immediately
pip install --upgrade gunicorn==23.0.0

# Verify installation
python -c "import gunicorn; print(f'Gunicorn version: {gunicorn.__version__}')"

# Restart gunicorn services
sudo systemctl restart gunicorn
```

### For Container Deployments
```bash
# Rebuild containers with updated requirements
docker build --no-cache -t lukhas-ai:security-patch .
docker stop lukhas-production
docker run -d --name lukhas-production lukhas-ai:security-patch
```

## Timeline

- **2024-08-10**: Gunicorn 23.0.0 released with security fixes
- **2025-09-21 18:45 UTC**: Vulnerabilities identified in LUKHAS AI dependencies
- **2025-09-21 18:50 UTC**: Emergency patch initiated
- **2025-09-21 19:00 UTC**: Dependency updates completed and tested
- **2025-09-21 19:05 UTC**: Security advisory published

## Prevention Measures

1. **Automated Dependency Scanning**: Enhanced Dependabot alerts monitoring
2. **Security CI/CD Gates**: Block deployments with HIGH/CRITICAL vulnerabilities
3. **Regular Security Reviews**: Weekly dependency vulnerability assessments
4. **Emergency Patch Process**: Established rapid response procedures

## Verification

To verify the fix is applied:

```bash
# Check gunicorn version
pip list | grep gunicorn
# Should show: gunicorn 23.0.0

# Verify no open security alerts
gh api /repos/LukhasAI/Lukhas/dependabot/alerts --jq '.[] | select(.state == "open" and .security_advisory.severity == "high")'
```

## Contact Information

- **Security Team**: security@lukhas.ai
- **Incident Response**: incident-response@lukhas.ai
- **Emergency Hotline**: Available via internal channels

---

**Document Classification**: Internal Security Advisory
**Distribution**: Engineering, DevOps, Security Teams
**Next Review**: Post-deployment verification (September 22, 2025)