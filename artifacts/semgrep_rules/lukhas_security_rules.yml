rules:
- id: lukhas-guardian-bypass
  languages:
  - python
  message: Potential Guardian system bypass detected
  metadata:
    category: security
    subcategory:
    - guardian-bypass
  pattern: $GUARDIAN.validate_request(..., bypass=True, ...)
  severity: ERROR
- id: lukhas-consciousness-unvalidated
  languages:
  - python
  message: Consciousness processing without Guardian validation
  metadata:
    category: security
    subcategory:
    - consciousness-validation
  patterns:
  - pattern: consciousness.$METHOD(...)
  - pattern-not-inside: guardian.validate(...)
  severity: WARNING
- id: lukhas-memory-injection
  languages:
  - python
  message: Potential memory injection vulnerability
  metadata:
    category: security
    subcategory:
    - injection
  pattern-either:
  - pattern: memory.query($USER_INPUT)
  - pattern: memory.embed($USER_INPUT)
  severity: ERROR
- id: lukhas-identity-weak-auth
  languages:
  - python
  message: Weak authentication configuration detected
  metadata:
    category: security
    subcategory:
    - authentication
  pattern-either:
  - pattern: jwt.decode(..., verify=False, ...)
  - pattern: auth_required=False
  severity: WARNING
- id: lukhas-oidc-insecure
  languages:
  - python
  message: Insecure OIDC configuration
  metadata:
    category: security
    subcategory:
    - oidc
  pattern-either:
  - pattern: verify_signature=False
  - pattern: verify_aud=False
  - pattern: verify_iss=False
  severity: ERROR
- id: lukhas-hardcoded-secrets
  languages:
  - python
  message: Hardcoded secret or credential detected
  metadata:
    category: security
    subcategory:
    - secrets
  pattern-either:
  - pattern: $VAR = "sk-..."
  - pattern: $VAR = "ghp_..."
  - pattern: password = "..."
  - pattern: api_key = "..."
  severity: ERROR
- id: lukhas-sql-injection
  languages:
  - python
  message: Potential SQL injection vulnerability
  metadata:
    category: security
    subcategory:
    - injection
  pattern-either:
  - pattern: cursor.execute(f"... {$VAR} ...")
  - pattern: query = f"... {$VAR} ..."
  severity: ERROR
- id: lukhas-unsafe-deserialization
  languages:
  - python
  message: Unsafe deserialization detected
  metadata:
    category: security
    subcategory:
    - deserialization
  pattern-either:
  - pattern: pickle.loads($VAR)
  - pattern: marshal.loads($VAR)
  - pattern: eval($VAR)
  severity: ERROR
